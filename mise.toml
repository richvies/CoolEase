[tools]
cmake = "latest"
gcc-arm-none-eabi = "latest"
ninja = "latest"
python = "3.10"
ruff = "latest"
uv = "latest"
ruby = "latest"

[env]
'_'.python.venv = { create = true, path = ".venv" }

[tasks.install-ceedling]
run = "gem install ceedling"

[tasks.clang-format]
run = 'find common sensor hub -name "*.c" -o -name "*.h" | xargs clang-format -i'

[tasks.reconfigure]
alias = "rconf"
run = "cmake . --preset {{arg(name='preset', i=1, default='debug')}}"

[tasks.build]
alias = "bu"
depends = "reconfigure"
run = 'cmake --build --preset {{arg(name="preset", i=1, default="debug")}}'

[tasks.fclean]
run = "rm -rf build"

[tasks.ffclean]
depends = "fclean"
run = "make -C libopencm3 clean"
